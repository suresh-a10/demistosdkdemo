contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
id: df3bef29-f6d1-44be-8f2c-1dd36462dca7
inputs:
- description: ""
  key: bamd5
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: hostname
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: username
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: http_status_code
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: src_ip
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: dst_ip
  playbookInputQuery: null
  required: false
  value: {}
name: Cust_IRC_Securonix_Zscaler Cloud Sandbox - Subplaybook
outputs: []
sourceplaybookid: e59c7ef9-c1de-47f7-8504-64dcf1d0403a
starttaskid: "0"
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a8af76a-276b-455c-80dc-db84fd7796af
      iscommand: false
      name: ""
      version: -1
    taskid: 4a8af76a-276b-455c-80dc-db84fd7796af
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 695,
          "y": -850
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      forEach: true
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        complex:
          root: inputs.hostname
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 539eb5e9-db75-4846-88cc-bc8bfd0d70e2
      iscommand: false
      name: Zscaler Patient 0 Compliance check
      playbookName: Zscaler Patient 0 Compliance check
      type: playbook
      version: -1
    taskid: 539eb5e9-db75-4846-88cc-bc8bfd0d70e2
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 265,
          "y": 575
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          root: inputs.username
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ebefa7c9-4b7a-4cc4-8261-b61c2fefbf22
      iscommand: false
      name: Zscaler_VIP_User_subplaybook
      playbookName: Zscaler_VIP_User_subplaybook
      type: playbook
      version: -1
    taskid: ebefa7c9-4b7a-4cc4-8261-b61c2fefbf22
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 50,
          "y": 925
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: Hostname_List
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: Username_VIP
            operator: append
          - operator: uniq
      listName:
        simple: Zscalar_Host_VIP_User_list
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 6e37a20d-95b6-4b08-820f-d8e1143e3ad1
      iscommand: true
      name: set to list for the hostnames and VIP user
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 6e37a20d-95b6-4b08-820f-d8e1143e3ad1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1120
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2c42d37f-d261-4ec5-8125-cf0b3c5d3521
      iscommand: false
      name: Cust_IRC_Generic_Host_Compliance_Check_using_EPO
      playbookName: Wipro_IRC_Generic_Host_Compliance_Check_using_EPO
      type: playbook
      version: -1
    taskid: 2c42d37f-d261-4ec5-8125-cf0b3c5d3521
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 695,
          "y": 225
        }
      }
  "12":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: EPO_OSPlatform
                root: ComplianceCheck
          operator: isEqualString
          right:
            value:
              simple: Workstation
      label: Endpoint
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "70"
      Endpoint:
      - "6"
      Server:
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b2d9984c-2592-4707-8ade-6d4d5d1b7292
      iscommand: false
      name: Check if the Host is a Server or Endpoint
      type: condition
      version: -1
    taskid: b2d9984c-2592-4707-8ade-6d4d5d1b7292
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": 400
        }
      }
  "13":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ITAM_Overall Compliance Status
                root: HostComplianceCheck
          operator: isEqualString
          right:
            value:
              simple: non-compliant
      label: Non-Compliant
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      Non-Compliant:
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60c8a604-50e2-47e0-833e-013e42e7aac9
      iscommand: false
      name: Check if Host is Non Compliant
      type: condition
      version: -1
    taskid: 60c8a604-50e2-47e0-833e-013e42e7aac9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 265,
          "y": 750
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "68"
      - "67"
    note: false
    quietmode: 0
    scriptarguments:
      username:
        complex:
          root: inputs.username
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2e09be49-0769-443e-8e91-96c322414eaa
      iscommand: false
      name: Zscaler_VIP_User_subplaybook
      playbookName: Zscaler_VIP_User_subplaybook
      type: playbook
      version: -1
    taskid: 2e09be49-0769-443e-8e91-96c322414eaa
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 480,
          "y": 925
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 90e15dfb-fa84-4a36-888a-ac50280f3af1
      iscommand: false
      name: Get the users list logged into the server via CS
      type: regular
      version: -1
    taskid: 90e15dfb-fa84-4a36-888a-ac50280f3af1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2120,
          "y": 1450
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: "<html><body>\n<div dir=\"ltr\"><img src=\"https://share1.cloudhq-mkt3.net/b63bfb4cd40349.jpeg\"
          alt=\"\" width=\"800\" height=\"171\">\n<br>\n<br>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">Hi IRC Lead,\n</p>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">This is AutoGenerated emailf from
          Demisto  for the Fireeye - network Monitoring tool  and alert is triggered
          \ for the Domain Match eventtype\n</p>\n<br>\n<p style=\"font-family: Arial;
          font-size: 16px; width: 800px;\">\nWe are from Cyber Defense team monitors
          the Wipro network for possible detection of Malicious activity Malware activity
          / Scan activity and it required immediate attention<br>\t\nPlease review
          the below information provided and provide the validation(s) and  recommendation(s)
          to be followed.<br>\t\nOur monitoring tool detected the alert for -  Zscaler
          Patient 0 Sandbox Malware & Malware Quarantine Subplaybook\nPart of the
          callback phase, This alert occurs when a Possible Patient zero event is
          logged <br><br><br>\n\n\nPlease find the Context gathering details available
          in the Evidence board of - Demisto Incident-<br><br>\n\n\nThe User involved
          in this incident is a VIP <br>\nPlease use the context building from the
          Demisto Incident evidence board<br>\n\n<p style=\"font-family: Arial; font-size:
          16px; width: 800px;\">\nValidation(s)<br><br>\t\t\t\t\t\t\t\t\t\t\n <br>\n</p>\n\n<br
          />\n\n<p style=\"font-family: Arial; font-size: 16px; width: 800px;\">\nThis
          is an automated email, please do not reply. If you have any queries please
          reach out to \n  <a href=\"mailto:irc-operations@wipro.com)\">irc-operations@wipro.com</a>.\n
          \ </p>\n<br />\n  <p style=\"font-family: Arial; font-size: 16px; width:
          800px;\">\n  Thanks and Regards,\n  <br>IRC - Operations\n  <br>Wipro-IRMC-Cyber
          Defense\n  <br>irc-operations@wipro.com\n  </p>\n<br>\n</div>\n</body></html>"
      subject:
        simple: '#{incident.priority} | ${incident.name}'
      to:
        complex:
          accessor: owner
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: irc-operations@wipro.com,irc-leads@wipro.com,
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 05077ee5-f36a-4cef-8f2a-e6f75ab6df79
      iscommand: true
      name: Send email notification to IRC leads
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 05077ee5-f36a-4cef-8f2a-e6f75ab6df79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1490
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: 'inputs.http_status_code '
                transformers:
                - operator: Stringify
          operator: isEqualString
          right:
            value:
              simple: "200"
      label: "200"
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "200":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 1e57613c-2441-4eb7-8274-e96e650c1836
      iscommand: false
      name: Check http_status_code
      type: condition
      version: -1
    taskid: 1e57613c-2441-4eb7-8274-e96e650c1836
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 350,
          "y": 1275
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      priority:
        simple: P2
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6efa2425-691e-4fed-84ac-a1c636ca9f6e
      iscommand: true
      name: Set incident priority as P2
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6efa2425-691e-4fed-84ac-a1c636ca9f6e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1902.5,
          "y": 1100
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    scriptarguments:
      priority:
        simple: P3
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 12b9f02b-f944-49b9-8e53-78da74b2cd5c
      iscommand: true
      name: Change the priority of the incident to P2(modified to default P3)
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 12b9f02b-f944-49b9-8e53-78da74b2cd5c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 1450
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c1fd8fe2-6aca-4a9a-870d-fc0ee7ca81a0
      iscommand: false
      name: Cust-Containment_subplaybook
      playbookName: Wipro-Containment_subplaybook
      type: playbook
      version: -1
    taskid: c1fd8fe2-6aca-4a9a-870d-fc0ee7ca81a0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 1800
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      query:
        simple: ' sourceBrand:"QRadar v3" (usernames:${inputs.username}) created:>="2
          days ago"'
    separatecontext: false
    skipunavailable: false
    task:
      brand: QRadar v3
      description: |-
        Searches Demisto incidents.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: a39b7e14-3c13-4933-8f74-648484b6ab3c
      iscommand: false
      name: Using hostname and username, check for any offence reported in last 48hr
        on SIEM
      script: SearchIncidentsV2
      type: regular
      version: -1
    taskid: a39b7e14-3c13-4933-8f74-648484b6ab3c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1790
        }
      }
  "25":
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which can be used across all other playbooks where the requirement is:
        * Querying CS with hostname to identify associated detections and incidents within the mentioned timeframe.
      id: e3369f0c-88d2-4069-8519-1c279ab4c3b7
      iscommand: false
      name: Cust_IRC_Generic_Determine CS detections and incidents for a given hostname
      playbookName: Wipro_IRC_Generic_Determine CS detections and incidents for a
        given hostname
      type: playbook
      version: -1
    taskid: e3369f0c-88d2-4069-8519-1c279ab4c3b7
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1480
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "38"
    note: false
    quietmode: 0
    scriptarguments:
      priority:
        simple: P3
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 6e2964ea-57cc-4724-8a50-1ee9bff08e14
      iscommand: true
      name: Change the priority of the incident to P2(modified to default P3)
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 6e2964ea-57cc-4724-8a50-1ee9bff08e14
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 1800
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Zscaler_Score
          operator: greaterThanOrEqual
          right:
            value:
              simple: "85"
      label: '>= 85'
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      '>= 85':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 58e88379-1945-4a74-8cd8-a02521c23ab8
      iscommand: false
      name: Check Zscaler score
      type: condition
      version: -1
    taskid: 58e88379-1945-4a74-8cd8-a02521c23ab8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 340,
          "y": 2120
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      priority:
        simple: P2
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 30fd481d-c356-4af3-862b-002b9bd66b0f
      iscommand: true
      name: Change Incident priority to P2
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 30fd481d-c356-4af3-862b-002b9bd66b0f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2325
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: "<html><body>\n<div dir=\"ltr\"><img src=\"https://share1.cloudhq-mkt3.net/b63bfb4cd40349.jpeg\"
          alt=\"\" width=\"800\" height=\"171\">\n<br>\n<br>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">Hi IRC Lead,\n</p>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">This is AutoGenerated emailf from
          Demisto  for the Fireeye - network Monitoring tool  and alert is triggered
          \ for the Domain Match eventtype\n</p>\n<br>\n<p style=\"font-family: Arial;
          font-size: 16px; width: 800px;\">\nWe are from Cyber Defense team monitors
          the Wipro network for possible detection of Malicious activity Malware activity
          / Scan activity and it required immediate attention<br>\t\nPlease review
          the below information provided and provide the validation(s) and  recommendation(s)
          to be followed.<br>\t\nOur monitoring tool detected the alert for -  Zscaler
          Patient 0 Sandbox Malware & Malware Quarantine\nPart of the callback phase,
          This alert occurs when a Possible Patient zero event is logged <br><br><br>\n\n\nPlease
          find the Context gathering details available in the Evidence board of -
          Demisto Incident-<br><br>\n\n\nThe Zscaler Score of the bamd5 value involved
          in this is greater than 85 <br>\nPlease use the context building from the
          Demisto Incident evidence board<br>\n\n<p style=\"font-family: Arial; font-size:
          16px; width: 800px;\">\nValidation(s)<br><br>\t\t\t\t\t\t\t\t\t\t\n <br>\n</p>\n\n<br
          />\n\n<p style=\"font-family: Arial; font-size: 16px; width: 800px;\">\nThis
          is an automated email, please do not reply. If you have any queries please
          reach out to \n  <a href=\"mailto:irc-operations@wipro.com)\">irc-operations@wipro.com</a>.\n
          \ </p>\n<br />\n  <p style=\"font-family: Arial; font-size: 16px; width:
          800px;\">\n  Thanks and Regards,\n  <br>IRC - Operations\n  <br>Wipro-IRMC-Cyber
          Defense\n  <br>irc-operations@wipro.com\n  </p>\n<br>\n</div>\n</body></html>"
      subject:
        simple: '#${incident.priority} | ${incident.name}'
      to:
        complex:
          accessor: owner
          root: incident
          transformers:
          - args:
              prefix:
                value:
                  simple: irc-operations@wipro.com,irc-leads@wipro.com,
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: 112667a8-af1f-421a-8867-7c07adc871e4
      iscommand: true
      name: Send email notification to IRC leads
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: 112667a8-af1f-421a-8867-7c07adc871e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2500
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 32ffa0a3-0f00-4ea7-8973-92db9921d8ba
      iscommand: false
      name: Cust-Containment_subplaybook
      playbookName: Wipro-Containment_subplaybook
      type: playbook
      version: -1
    taskid: 32ffa0a3-0f00-4ea7-8973-92db9921d8ba
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2675
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which can be used across all other playbooks where the requirement is:
        * Querying CS with hostname and IOC to identify the processes involved in the initiation of the connection
      id: 3296e63d-d10d-4e3c-8f2d-86717af22eb8
      iscommand: false
      name: Cust_IRC_Generic_Find processes on CS using hostname and ioc
      playbookName: Wipro_IRC_Generic_Find processes on CS using hostname and ioc
      type: playbook
      version: -1
    taskid: 3296e63d-d10d-4e3c-8f2d-86717af22eb8
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2850
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which can be used across all other playbooks where the requirement is:
        * Querying CS with hostname and IOC to identify the processes involved in the initiation of the connection
      id: f49f4fe9-6536-40eb-8a3f-20fd45c64821
      iscommand: false
      name: Cust_IRC_Generic_Find processes on CS using hostname and ioc
      playbookName: Wipro_IRC_Generic_Find processes on CS using hostname and ioc
      type: playbook
      version: -1
    taskid: f49f4fe9-6536-40eb-8a3f-20fd45c64821
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 705,
          "y": 2325
        }
      }
  "35":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: file_name
                root: CrowdStrike.Process
          operator: containsString
          right:
            value:
              simple: chrome.exe
        - left:
            iscontext: true
            value:
              complex:
                accessor: file_name
                root: CrowdStrike.Process
          operator: containsString
          right:
            value:
              simple: msedge.exe
        - left:
            iscontext: true
            value:
              complex:
                accessor: file_name
                root: CrowdStrike.Process
          operator: containsString
          right:
            value:
              simple: firefox.exe
        - left:
            iscontext: true
            value:
              complex:
                accessor: file_name
                root: CrowdStrike.Process
          operator: containsString
          right:
            value:
              simple: iexplorer.exe
      label: browser
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "36"
      browser:
      - "37"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 685e4724-cf4d-4c05-857f-b7d190055601
      iscommand: false
      name: Check if Process involved is a browser
      type: condition
      version: -1
    taskid: 685e4724-cf4d-4c05-857f-b7d190055601
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 2675
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      priority:
        simple: P3
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 02c2a5ac-5053-4932-8843-c7a053f79c41
      iscommand: true
      name: set P2 priority of the incident(modified to default P3)
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 02c2a5ac-5053-4932-8843-c7a053f79c41
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 2850
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      priority:
        simple: P3
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: be7214c9-7ffe-4147-870f-b56e9b95c6cd
      iscommand: true
      name: set P3 priority of the incident
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: be7214c9-7ffe-4147-870f-b56e9b95c6cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2850
        }
      }
  "38":
    continueonerror: true
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 1
    scriptarguments:
      extend-context:
        simple: Zscaler_Status=Full Details.Summary.Status::Zscaler_Category=Full
          Details.Classification.Category::Zscaler_Score=Full Details.Classification.Score
      value:
        simple: Due to the API limit on querying for Sanbox report removing the duplicate
          Sandbox report queries
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: 9359a717-e728-46ad-8f73-e7c11cc7c6e3
      iscommand: false
      name: Zscaler Sandbox Report
      script: Print
      type: regular
      version: -1
    taskid: 9359a717-e728-46ad-8f73-e7c11cc7c6e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1462.5,
          "y": 1975
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      hostname:
        simple: ${inputs.hostname}
      ioc_type:
        simple: md5
      ioc_value:
        simple: ${inputs.bamd5}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which can be used across all other playbooks where the requirement is:
        * Querying CS with hostname and IOC to identify the processes involved in the initiation of the connection
      id: 37a7317a-d541-4e4e-8189-5e21727bc2f1
      iscommand: false
      name: Wipro_IRC_Generic_Find processes on CS using hostname and ioc
      playbookName: Wipro_IRC_Generic_Find processes on CS using hostname and ioc
      type: playbook
      version: -1
    taskid: 37a7317a-d541-4e4e-8189-5e21727bc2f1
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1462.5,
          "y": 2150
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 1
    scriptarguments:
      extend-context:
        simple: Zscaler_Status=Full Details.Summary.Status::Zscaler_Category=Full
          Details.Classification.Category::Zscaler_Score=Full Details.Classification.Score
      value:
        simple: Due to the API limit on querying for Sanbox report removing the duplicate
          Sandbox report queries
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Prints text to war room (Markdown supported)
      id: f6a6abe1-eb2f-4978-8b6a-a70f0fff4d7c
      iscommand: false
      name: Zscaler Sandbox Report
      script: Print
      type: regular
      version: -1
    taskid: f6a6abe1-eb2f-4978-8b6a-a70f0fff4d7c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1902.5,
          "y": 1275
        }
      }
  "41":
    continueonerror: true
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
    note: false
    quietmode: 0
    scriptarguments:
      extend-context:
        simple: Zscaler_Status=Full Details.Summary.Status::Zscaler_Category=Full
          Details.Classification.Category::Zscaler_Score=Full Details.Classification.Score
      value:
        simple: Zscaler Sandbox report unavailable in PDF format
    separatecontext: false
    skipunavailable: false
    task:
      brand: Zscaler - Fixed
      description: Prints text to war room (Markdown supported)
      id: 919baee4-1b83-43f5-8626-9894de7e0737
      iscommand: false
      name: Zscaler Sandbox full Report in PDF
      script: Print
      type: regular
      version: -1
    taskid: 919baee4-1b83-43f5-8626-9894de7e0737
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 3050
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "75"
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: ${inputs.bamd5}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Gets a quick indicator of the risk associated with a file.
      id: 5066c593-d32b-4da9-8121-df887e2ea08a
      iscommand: true
      name: Md5 hash, reputation check in DBOT
      script: '|||file'
      type: regular
      version: -1
    taskid: 5066c593-d32b-4da9-8121-df887e2ea08a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 3275
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "47"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9044a436-53a7-48ee-858f-71f563d2effd
      iscommand: false
      name: Cust_IP Enrichment
      playbookName: Wipro_IP Enrichment
      type: playbook
      version: -1
    taskid: 9044a436-53a7-48ee-858f-71f563d2effd
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 3850
        }
      }
  "47":
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 69ff1355-0844-4b1e-8bec-ecf90326ae83
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 69ff1355-0844-4b1e-8bec-ecf90326ae83
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 4060
        }
      }
  "49":
    continueonerrortype: ""
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      details:
        simple: full
      extend-context:
        simple: Zscaler_Status=Full Details.Summary.Status::Zscaler_Category=Full
          Details.Classification.Category::Zscaler_Score=Full Details.Classification.Score
      md5:
        complex:
          root: inputs.bamd5
      retry-count:
        simple: "0"
      retry-interval:
        simple: "0"
      using:
        simple: Zscaler_Sandbox_Report
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Retrieves a full or summary report of the file that was analyzed
        by Sandbox. The file is represented by the specified MD5 hash.
      id: 8a8b38bd-44a4-4623-89cf-9ca58f4d9a8b
      iscommand: true
      name: query Zscaler for md5 report
      script: '|||zscaler-sandbox-report'
      type: regular
      version: -1
    taskid: 8a8b38bd-44a4-4623-89cf-9ca58f4d9a8b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 695,
          "y": -410
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Zscaler_Status
          operator: isEqualString
          right:
            value:
              simple: NODYNAMIC
        - left:
            iscontext: true
            value:
              complex:
                root: Zscaler_Status
          operator: isEqualString
          right:
            value:
              simple: COMPLETED
      label: if no dynamic/completed
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "52"
      if no dynamic/completed:
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 902bccdc-d449-49c5-8057-3e5bc791e051
      iscommand: false
      name: Check the status
      type: condition
      version: -1
    taskid: 902bccdc-d449-49c5-8057-3e5bc791e051
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": -245
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: Zscaler_Category
          operator: isEqualString
          right:
            value:
              simple: BENIGN
        - left:
            iscontext: true
            value:
              complex:
                accessor: DetectedMalware
                root: File.Zscaler
          operator: isEqualString
          right:
            value:
              simple: None
        - left:
            iscontext: true
            value:
              complex:
                root: Zscaler_Category
          operator: isEqualString
          right:
            value:
              simple: NONE
      label: benign
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      benign:
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 54138597-130e-415b-88f5-033b7128bda2
      iscommand: false
      name: Check the classification
      type: condition
      version: -1
    taskid: 54138597-130e-415b-88f5-033b7128bda2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": -30
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a7a78ef0-748a-4b90-8e86-1f00f1c202e4
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: a7a78ef0-748a-4b90-8e86-1f00f1c202e4
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": -60
        }
      }
  "54":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.bamd5
          operator: isEmpty
          right:
            value: {}
        - left:
            iscontext: true
            value:
              complex:
                root: inputs.md5
          operator: isEqualString
          right:
            value:
              simple: None
      label: Empty
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "49"
      Empty:
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e1a4bac-52e3-4496-8bf3-342a9e3f4c79
      iscommand: false
      name: Check if bamd5 value is empty
      type: condition
      version: -1
    taskid: 4e1a4bac-52e3-4496-8bf3-342a9e3f4c79
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 695,
          "y": -660
        }
      }
  "55":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Process
                root: CrowdStrike
          operator: isExists
          right:
            value: {}
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Process
                root: CrowdStrike
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: abd69471-6ab3-4af2-87a9-4b3ec1469d95
      iscommand: false
      name: Check if CS has brought any result
      type: condition
      version: -1
    taskid: abd69471-6ab3-4af2-87a9-4b3ec1469d95
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 705,
          "y": 2510
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    note: false
    quietmode: 0
    scriptarguments:
      AQL:
        simple: select QIDNAME(qid) as 'Event Name',logsourcename(logSourceId) as
          'Log Source',"eventCount" as 'Event Count',DATEFORMAT(starttime,'yyyy-MM-dd
          h:m:s a') as 'Time',categoryname(category) as 'Low Level Category',"sourceIP"
          as 'Source IP',"sourcePort" as 'Source Port',"destinationIP" as 'Destination
          IP',"destinationPort" as 'Destination Port',"userName" as 'Username',"HostName(AV
          ePO)" as 'HostName(AV ePO) (custom)',"SourceProcessEpo" as 'SourceProcessEpo
          (custom)',"ThreatName(AV ePO)" as 'ThreatName(AV ePO) (custom)',"Threat
          handled_EPO" as 'Threat handled_EPO (custom)',"EPO_Threat_Event_Id" as 'EPO_Threat_Event_Id
          (custom)' from events where ( ( "HostName(AV ePO)" ilike '%${inputs.hostname}%'
          OR "userName" ilike '%${inputs.username}%') AND "deviceType"='93' ) order
          by "startTime" desc last 48 hours
      EvidenceDescription:
        simple: The EPO logs for the given Username and Hostname
      EvidenceRequired:
        simple: "yes"
      key:
        simple: EPO_Logs
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This is a generic playbook which performs a QRadar search with the input AQL and stores the output events in the input key in the form:
        * key.events

        ### Note - Always run this as a sub playbook in private mode
      id: e835e334-1d7e-4202-8667-e60fdeecfa23
      iscommand: false
      name: Using hostname and username, check for any detection AV(McAfee) for last
        48hr
      playbookName: Wipro_IRC_Generic_QRadar_Logs
      type: playbook
      version: -1
    taskid: e835e334-1d7e-4202-8667-e60fdeecfa23
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1625
        }
      }
  "60":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: EPO_Logs
          operator: containsGeneral
          right:
            value:
              simple: '"Data":"No results returned by QRadar"'
        - left:
            iscontext: true
            value:
              complex:
                accessor: Detection
                root: CrowdStrike
          operator: isEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: foundIncidents
          operator: isEmpty
      label: No results
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      No results:
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e6787886-4c9b-4835-8677-85ae782eef17
      iscommand: false
      name: Check if any results found
      type: condition
      version: -1
    taskid: e6787886-4c9b-4835-8677-85ae782eef17
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 340,
          "y": 1935
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: "<html><body>\n<div dir=\"ltr\"><img src=\"https://share1.cloudhq-mkt3.net/b63bfb4cd40349.jpeg\"
          alt=\"\" width=\"800\" height=\"171\">\n<br>\n<br>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">Hi IRC Lead,\n</p>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">This is AutoGenerated emailf from
          Demisto  for the Fireeye - network Monitoring tool  and alert is triggered
          \ for the Domain Match eventtype\n</p>\n<br>\n<p style=\"font-family: Arial;
          font-size: 16px; width: 800px;\">\nWe are from Cyber Defense team monitors
          the Wipro network for possible detection of Malicious activity Malware activity
          / Scan activity and it required immediate attention<br>\t\nPlease review
          the below information provided and provide the validation(s) and  recommendation(s)
          to be followed.<br>\t\nOur monitoring tool detected the alert for -  Zscaler
          Patient 0 Sandbox Malware & Malware Quarantine \nPart of the callback phase,
          This alert occurs when a Possible Patient zero event is logged <br><br><br>\n\n\nPlease
          find the Context gathering details available in the Evidence board of -
          Demisto Incident-<br><br>\n\n\nThe status Code response from the server
          is 200 or the there were other incidents found with the given hostname or
          Username <br>\nPlease use the context building from the Demisto Incident
          evidence board<br>\n\n<p style=\"font-family: Arial; font-size: 16px; width:
          800px;\">\nValidation(s)<br><br>\t\t\t\t\t\t\t\t\t\t\n <br>\n</p>\n\n<br
          />\n\n<p style=\"font-family: Arial; font-size: 16px; width: 800px;\">\nThis
          is an automated email, please do not reply. If you have any queries please
          reach out to \n  <a href=\"mailto:irc-operations@wipro.com)\">irc-operations@wipro.com</a>.\n
          \ </p>\n<br />\n  <p style=\"font-family: Arial; font-size: 16px; width:
          800px;\">\n  Thanks and Regards,\n  <br>IRC - Operations\n  <br>Wipro-IRMC-Cyber
          Defense\n  <br>irc-operations@wipro.com\n  </p>\n<br>\n</div>\n</body></html>"
      subject:
        simple: '#${incident.priority} | ${incident.name}'
      to:
        complex:
          root: analystemail
          transformers:
          - args:
              prefix:
                value:
                  simple: irc-operations@wipro.com,irc-leads@wipro.com,
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: d763fcb2-18b2-4f9b-8486-452263845de0
      iscommand: true
      name: Send email notification to IRC leads
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: d763fcb2-18b2-4f9b-8486-452263845de0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1247.5,
          "y": 1625
        }
      }
  "66":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: VIP_user
                transformers:
                - operator: Stringify
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: VIP User
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "17"
      VIP User:
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 08982d9c-ee72-4cd0-83e2-86ef56368834
      iscommand: false
      name: Check if the user is VIP
      type: condition
      version: -1
    taskid: 08982d9c-ee72-4cd0-83e2-86ef56368834
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1290
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      listData:
        complex:
          root: Hostname_List
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: Username_VIP
            operator: append
          - operator: uniq
      listName:
        simple: Zscalar_Host_VIP_User_list
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.list.set
      id: 60040fd6-2da3-46bd-8777-3f3c6a667532
      iscommand: true
      name: set to list for the hostnames and VIP user
      script: Builtin|||setList
      type: regular
      version: -1
    taskid: 60040fd6-2da3-46bd-8777-3f3c6a667532
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 940,
          "y": 1085
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: VIP_user
                transformers:
                - operator: Stringify
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: VIP User
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "26"
      VIP User:
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 55ee07db-123a-4a91-85eb-34cbe3d54e67
      iscommand: false
      name: Check if the user is VIP
      type: condition
      version: -1
    taskid: 55ee07db-123a-4a91-85eb-34cbe3d54e67
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1085
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        simple: "<html><body>\n<div dir=\"ltr\"><img src=\"https://share1.cloudhq-mkt3.net/b63bfb4cd40349.jpeg\"
          alt=\"\" width=\"800\" height=\"171\">\n<br>\n<br>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">Hi IRC Lead,\n</p>\n<p style=\"font-family:
          Arial; font-size: 16px; width: 800px;\">This is AutoGenerated emailf from
          Demisto  for the Fireeye - network Monitoring tool  and alert is triggered
          \ for the Domain Match eventtype\n</p>\n<br>\n<p style=\"font-family: Arial;
          font-size: 16px; width: 800px;\">\nWe are from Cyber Defense team monitors
          the Wipro network for possible detection of Malicious activity Malware activity
          / Scan activity and it required immediate attention<br>\t\nPlease review
          the below information provided and provide the validation(s) and  recommendation(s)
          to be followed.<br>\t\nOur monitoring tool detected the alert for -  Zscaler
          Patient 0 Sandbox Malware & Malware Quarantine\nPart of the callback phase,
          This alert occurs when a Possible Patient zero event is logged <br><br><br>\n\n\nPlease
          find the Context gathering details available in the Evidence board of -
          Demisto Incident-<br><br>\n\n\nThe User involved in this incident is a VIP
          <br>\nPlease use the context building from the Demisto Incident evidence
          board<br>\n\n<p style=\"font-family: Arial; font-size: 16px; width: 800px;\">\nValidation(s)<br><br>\t\t\t\t\t\t\t\t\t\t\n
          <br>\n</p>\n\n<br />\n\n<p style=\"font-family: Arial; font-size: 16px;
          width: 800px;\">\nThis is an automated email, please do not reply. If you
          have any queries please reach out to \n  <a href=\"mailto:irc-operations@wipro.com)\">irc-operations@wipro.com</a>.\n
          \ </p>\n<br />\n  <p style=\"font-family: Arial; font-size: 16px; width:
          800px;\">\n  Thanks and Regards,\n  <br>IRC - Operations\n  <br>Wipro-IRMC-Cyber
          Defense\n  <br>irc-operations@wipro.com\n  </p>\n<br>\n</div>\n</body></html>"
      subject:
        simple: '#${incident.priority} | ${incident.name}'
      to:
        complex:
          root: analystemail
          transformers:
          - args:
              prefix:
                value:
                  simple: irc-operations@wipro.com,irc-leads@wipro.com,
              suffix: {}
            operator: concat
    separatecontext: false
    skipunavailable: false
    task:
      brand: EWS Mail Sender
      description: Sends an email using EWS.
      id: a8ee6025-979d-4f12-87c9-56400c5797d9
      iscommand: true
      name: Send email notification to IRC leads
      script: EWS Mail Sender|||send-mail
      type: regular
      version: -1
    taskid: a8ee6025-979d-4f12-87c9-56400c5797d9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1720,
          "y": 1625
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8f4e44a7-ea94-4aad-84be-b45c1e3136d5
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 8f4e44a7-ea94-4aad-84be-b45c1e3136d5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 640
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    scriptarguments:
      column_headers:
        simple: accountname,message,sourceaddress,deviceaddress,requestmethod,sourceport,destinationport,filename,deviceeventcategory,requesturl
      hours_ago:
        simple: 24 hours ago
      spotter_description:
        simple: MD5 hash sweep in fireeye
      spotter_query:
        simple: resourcegroupname = "Wipro-BITS-Prod-FireEye-CM1-wipro-com"  AND tenantname
          = "WIPRO" and filehash = "${inputs.bamd5}"
      spotter_results_key:
        simple: spotter_results_md5_hash_sweep_fireeye
      time_zone:
        simple: IST
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 43d9a5b0-ee1b-47c9-83e8-6bc2e3de9f47
      iscommand: false
      name: MD5 hash sweep in fireeye (Spotter Query)
      playbookName: Wipro_IRC_Securonix_Generic_Get_Activity_Data
      type: playbook
      version: -1
    taskid: 43d9a5b0-ee1b-47c9-83e8-6bc2e3de9f47
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 3450
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      column_headers:
        simple: accountname,message,sourceaddress,deviceaddress,requestmethod,sourceport,destinationport,filename,deviceeventcategory,requesturl
      hours_ago:
        simple: 24 hours ago
      spotter_description:
        simple: Bidirectional traffic logs between source and destination
      spotter_query:
        simple: resourcegroupname = "Wipro-BITS-Prod_Zscaler ZIA"  AND tenantname
          = "WIPRO" and sourceaddress = ${inputs.src_ip} OR  ${inputs.dst_ip} AND
          destinationaddress=  ${inputs.dst_ip} OR ${inputs.src_ip} accountname =
          ${inputs.username}
      spotter_results_key:
        simple: spotter_results_bidirectional_proxy_logs
      time_zone:
        simple: IST
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d12af73c-e2bc-4046-8f27-0bd7fe47558a
      iscommand: false
      name: Bidirectional traffic logs  (Spotter Query)
      playbookName: Wipro_IRC_Securonix_Generic_Get_Activity_Data
      type: playbook
      version: -1
    taskid: d12af73c-e2bc-4046-8f27-0bd7fe47558a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1200,
          "y": 3650
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "12_6_Endpoint": 0.56,
      "35_37_browser": 0.58,
      "50_52_#default#": 0.42,
      "51_52_benign": 0.54,
      "55_35_yes": 0.59,
      "60_29_No results": 0.29
    },
    "paper": {
      "dimensions": {
        "height": 4975,
        "width": 2770,
        "x": -270,
        "y": -850
      }
    }
  }
